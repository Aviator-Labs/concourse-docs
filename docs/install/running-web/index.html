
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://aviator-labs.github.io/concourse-docs/docs/install/running-web/">
      
      
        <link rel="prev" href="../generating-keys/">
      
      
        <link rel="next" href="../running-worker/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Running a web Node - Concourse Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-a-web-node" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Concourse Docs" class="md-header__button md-logo" aria-label="Concourse Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Concourse Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Running a web Node
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Aviator-Labs/concourse-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Aviator-Labs/concourse-docs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Concourse

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Docs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../project/" class="md-tabs__link">
        
  
  
    
  
  Project

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../ecosystem/" class="md-tabs__link">
        
  
  
    
  
  Ecosystem

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../support/" class="md-tabs__link">
        
  
  
    
  
  Support

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Concourse Docs" class="md-nav__button md-logo" aria-label="Concourse Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Concourse Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Aviator-Labs/concourse-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Aviator-Labs/concourse-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concourse
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Docs
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../getting-started/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Install
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Install
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-postgres/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running a PostgreSQL Node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concourse-cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The concourse CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generating-keys/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generating Keys
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Running a web node
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Running a web node
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-concourse-web" class="md-nav__link">
    <span class="md-ellipsis">
      Running concourse web
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running concourse web">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-utilization" class="md-nav__link">
    <span class="md-ellipsis">
      Resource utilization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operating-a-web-node" class="md-nav__link">
    <span class="md-ellipsis">
      Operating a web node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operating a web node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scaling" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scaling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database-connection-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Database connection pooling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reloading-worker-authorized-key" class="md-nav__link">
    <span class="md-ellipsis">
      Reloading worker authorized key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restarting-upgrading" class="md-nav__link">
    <span class="md-ellipsis">
      Restarting &amp; Upgrading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downgrading" class="md-nav__link">
    <span class="md-ellipsis">
      Downgrading
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-the-web-node" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring the web node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring the web node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#giving-your-cluster-a-name" class="md-nav__link">
    <span class="md-ellipsis">
      Giving your cluster a name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-ingress-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring ingress traffic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-via-lets-encrypt" class="md-nav__link">
    <span class="md-ellipsis">
      TLS via Let's Encrypt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-log-retention" class="md-nav__link">
    <span class="md-ellipsis">
      Build log retention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-audit-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling audit logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-defaults-for-resource-types" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring defaults for resource types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-worker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running a worker node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrading-concourse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Upgrading Concourse
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../auth-and-teams/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Auth & Teams
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The fly CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../pipelines/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Pipelines
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../vars/index.md" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Vars
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../resources/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../resource-types/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Resource Types
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../steps/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Steps
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../builds/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Builds
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../how-to/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    How-To Guides
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../operation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Operation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../observation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Observation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../internals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Internals
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../examples/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ecosystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ecosystem
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../blog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-concourse-web" class="md-nav__link">
    <span class="md-ellipsis">
      Running concourse web
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running concourse web">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-utilization" class="md-nav__link">
    <span class="md-ellipsis">
      Resource utilization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operating-a-web-node" class="md-nav__link">
    <span class="md-ellipsis">
      Operating a web node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operating a web node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scaling" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scaling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database-connection-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Database connection pooling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reloading-worker-authorized-key" class="md-nav__link">
    <span class="md-ellipsis">
      Reloading worker authorized key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restarting-upgrading" class="md-nav__link">
    <span class="md-ellipsis">
      Restarting &amp; Upgrading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downgrading" class="md-nav__link">
    <span class="md-ellipsis">
      Downgrading
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-the-web-node" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring the web node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring the web node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#giving-your-cluster-a-name" class="md-nav__link">
    <span class="md-ellipsis">
      Giving your cluster a name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-ingress-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring ingress traffic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-via-lets-encrypt" class="md-nav__link">
    <span class="md-ellipsis">
      TLS via Let's Encrypt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-log-retention" class="md-nav__link">
    <span class="md-ellipsis">
      Build log retention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-audit-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling audit logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-defaults-for-resource-types" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring defaults for resource types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="running-a-web-node">Running a <code>web</code> node</h1>
<p>The <code>web</code> node is responsible for running the web UI, API, and as well as performing all pipeline scheduling. It's
basically the brain of Concourse.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Nothing special - the <code>web</code> node is a pretty simple Go application that can be run like
a <a href="https://en.wikipedia.org/wiki/Twelve-Factor_App_methodology">12-factor app</a>.</p>
<h2 id="running-concourse-web">Running <code>concourse web</code></h2>
<p>The <code>concourse</code> CLI can run as a <code>web</code> node via the <code>web</code> subcommand.</p>
<p>Before running it, let's configure a local user so we can log in:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nv">CONCOURSE_ADD_LOCAL_USER</span><span class="o">=</span>myuser:mypass
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nv">CONCOURSE_MAIN_TEAM_LOCAL_USER</span><span class="o">=</span>myuser
</span></code></pre></div>
<p>This will configure a single user, <code>myuser</code>, with the password <code>mypass</code>. You'll probably want to change those to
sensible values, and later you may want to configure a proper auth provider - check
out <a href="https://concourse-ci.org/auth.html">Auth &amp; Teams</a> whenever you're ready.</p>
<p>Next, you'll need to configure the session signing key, the SSH key for the worker gateway, and the authorized worker
key. Check <a href="../generating-keys/">Generating Keys</a> to learn what these are and how they are created.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nv">CONCOURSE_SESSION_SIGNING_KEY</span><span class="o">=</span>path/to/session_signing_key
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nv">CONCOURSE_TSA_HOST_KEY</span><span class="o">=</span>path/to/tsa_host_key
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nv">CONCOURSE_TSA_AUTHORIZED_KEYS</span><span class="o">=</span>path/to/authorized_worker_keys.pub
</span></code></pre></div>
<p>Finally, <code>web</code> needs to know how to reach your Postgres database. This can be set like so:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nv">CONCOURSE_POSTGRES_HOST</span><span class="o">=</span><span class="m">127</span>.0.0.1<span class="w"> </span><span class="c1"># default</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nv">CONCOURSE_POSTGRES_PORT</span><span class="o">=</span><span class="m">5432</span><span class="w">      </span><span class="c1"># default</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nv">CONCOURSE_POSTGRES_DATABASE</span><span class="o">=</span>atc<span class="w">   </span><span class="c1"># default</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="nv">CONCOURSE_POSTGRES_USER</span><span class="o">=</span>my-user
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nv">CONCOURSE_POSTGRES_PASSWORD</span><span class="o">=</span>my-password
</span></code></pre></div>
<p>If you're running PostgreSQL locally, you can probably just point it to the socket and rely on the <code>peer</code> auth:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">CONCOURSE_POSTGRES_SOCKET</span><span class="o">=</span>/var/run/postgresql
</span></code></pre></div>
<p>Now that everything's set, run:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>concourse<span class="w"> </span>web
</span></code></pre></div>
<p>All logs will be emitted to <code>stdout</code>, with any panics or lower-level errors being emitted to <code>stderr</code>.</p>
<h3 id="resource-utilization">Resource utilization</h3>
<p>CPU usage: peaks during pipeline scheduling, primarily when scheduling <a href="https://concourse-ci.org/jobs.html">Jobs</a>.
Mitigated by adding more <code>web</code> nodes. In this regard, <code>web</code> nodes can be considered compute-heavy more than anything
else at large scale.</p>
<p>Memory usage: not very well classified at the moment as it's not generally a concern. Give it a few gigabytes and keep
an eye on it.</p>
<p>Disk usage: none</p>
<p>Bandwidth usage: aside from handling external traffic, the <code>web</code> node will at times have to stream bits out from one
worker and into another while executing <a href="https://concourse-ci.org/steps.html">Steps</a>.</p>
<p>Highly available: <code>yes</code>; web nodes can all be configured the same (aside from <code>--peer-address</code>) and placed behind a load
balancer. Periodic tasks like garbage-collection will not be duplicated for each node.</p>
<p>Horizontally scalable: yes; they will coordinate workloads using the database, resulting in less work for each node and
thus lower CPU usage.</p>
<p>Outbound traffic:</p>
<ul>
<li><code>db</code> on its configured port for persistence</li>
<li><code>db</code> on its configured port for locking and coordinating in a multi-<code>web</code> node deployment</li>
<li>other <code>web</code> nodes (possibly itself) on an <a href="https://en.wikipedia.org/wiki/Ephemeral_port">ephemeral port</a> when a worker
  is forwarded through the web node's TSA</li>
</ul>
<p>Inbound traffic:</p>
<ul>
<li><code>worker</code> connects to the TSA on port <code>2222</code> for registration</li>
<li><code>worker</code> downloads inputs from the ATC during <a href="https://concourse-ci.org/tasks.html#running-tasks"><code>fly execute</code></a> via
  its external URL</li>
<li>external traffic to the ATC API via the web UI and <a href="https://concourse-ci.org/fly.html"><code>fly</code> CLI</a></li>
</ul>
<h2 id="operating-a-web-node">Operating a <code>web</code> node</h2>
<p>The <code>web</code> nodes themselves are stateless - they don't store anything on disk, and coordinate entirely using the
database.</p>
<h3 id="scaling">Scaling</h3>
<p>The <a href="./"><code>web</code> node</a> can be scaled up for high availability. They'll also
roughly share their scheduling workloads, using the database to synchronize. This is done by just running more <code>web</code>
commands on different machines, and optionally putting them behind a load balancer.</p>
<p>To run a cluster of <a href="./"><code>web</code> nodes</a>, you'll first need to ensure they're all pointing to the same
PostgreSQL server.</p>
<p>Next, you'll need to configure a peer address. This is a DNS or IP address that can be used to reach this <code>web</code> node
from other <code>web</code> nodes. Typically this uses a private IP, like so:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nv">CONCOURSE_PEER_ADDRESS</span><span class="o">=</span><span class="m">10</span>.10.0.1
</span></code></pre></div>
<p>This address will be used for forwarded worker connections, which listen on
the <a href="https://en.wikipedia.org/wiki/Ephemeral_port">ephemeral port</a> range.</p>
<p>Finally, if all of these nodes are going to be accessed through a load balancer, you'll need to configure the external
URL that will be used to reach your Concourse cluster:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nv">CONCOURSE_EXTERNAL_URL</span><span class="o">=</span>https://ci.example.com
</span></code></pre></div>
<p>Aside from the peer URL, all configuration must be consistent across all <code>web</code> nodes in the cluster to ensure consistent
results.</p>
<h4 id="database-connection-pooling">Database connection pooling</h4>
<p>You may wish to configure the max number of parallel database connections that each node makes. There are two pools to
configure: one for serving API requests, and one used for all the backend work such as pipeline scheduling.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nv">CONCOURSE_API_MAX_CONNS</span><span class="o">=</span><span class="m">10</span><span class="w">     </span><span class="c1"># default</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nv">CONCOURSE_BACKEND_MAX_CONNS</span><span class="o">=</span><span class="m">50</span><span class="w"> </span><span class="c1"># default</span>
</span></code></pre></div>
<p>There are some non-configurable connection pools. They take up the following number of connections per pool:</p>
<ul>
<li>Garbage Collection: 5</li>
<li>Lock: 1</li>
<li>Worker Registration: 1</li>
</ul>
<p>The sum of these numbers across all <code>web</code> nodes should not be greater than the maximum number of simultaneous
connections your Postgres server will allow. See <a href="../running-postgres/#resource-utilization">
<code>db</code> node resource utilization</a> for more
information.</p>
<p>For example, if 3 <code>web</code> nodes are configured with the values shown above then your PostgreSQL server should be
configured with a connection limit of at least 201: <code>(10 + 50 + 5 + 1 + 1) * 3 web nodes</code>.</p>
<h3 id="reloading-worker-authorized-key">Reloading worker authorized key</h3>
<p>While <a href="./#running-concourse-web">Running <code>concourse web</code></a>, the authorized worker key
file, which contains all public keys for the workers, is loaded at startup. During the lifecycle of a <a href="./">
<code>web</code> node</a> new <code>worker</code> keys might be added or old ones removed. To
perform a live reload of this file you can send a <code>SIGHUP</code> signal to the <code>concourse web</code> process. The process will
remain running and Concourse will reload the authorized worker key file.</p>
<h3 id="restarting-upgrading">Restarting &amp; Upgrading</h3>
<p>The <code>web</code> nodes can be killed and restarted willy-nilly. No draining is necessary; if the <code>web</code> node was orchestrating a
build it will continue where it left off when it comes back, or the build will be picked up by one of the other <code>web</code>
nodes.</p>
<p>To upgrade a <code>web</code> node, stop its process and start a new one using the newly installed <code>concourse</code>. Any database
migrations will be run automatically on start. If <code>web</code> nodes are started in parallel, only one will run the migrations.</p>
<p>We don't currently guarantee a lack of funny-business if you're running mixed Concourse versions - database migrations
can perform modifications that confuse other <code>web</code> nodes. So there may be some turbulence during a rolling upgrade, but
everything should stabilize once all <code>web</code> nodes are running the latest version.</p>
<p>If you want more control over when the database migrations happen and know if they were successful you can use the
<code>concourse migrate</code> command. The <code>migrate</code> command accepts the same <code>CONCOURSE_POSTGRES_*</code> env vars as the
<code>concourse web</code> command.</p>
<h3 id="downgrading">Downgrading</h3>
<p>If you're stuck in a pinch and need to downgrade from one version of Concourse to another, you can use the
<code>concourse migrate</code> command.</p>
<p>First, grab the desired migration version by running the following:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># make sure this is the *old* Concourse binary</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>$<span class="w"> </span>concourse<span class="w"> </span>migrate<span class="w"> </span>--supported-db-version
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="m">1551110547</span>
</span></code></pre></div>
<p>That number (yours will be different) is the expected migration version for that version of Concourse.</p>
<p>Next, run the following with the new Concourse binary:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>concourse<span class="w"> </span>migrate<span class="w"> </span>--migrate-db-to-version<span class="o">=</span><span class="m">1551110547</span>
</span></code></pre></div>
<p>This will need the same <code>CONCOURSE_POSTGRES_*</code> configuration described in <a href="./#running-concourse-web">Running
<code>concourse web</code></a>.</p>
<p>Once this completes, switch all <code>web</code> nodes back to the older <code>concourse</code> binary and you should be good to go.</p>
<h2 id="configuring-the-web-node">Configuring the <code>web</code> node</h2>
<h3 id="giving-your-cluster-a-name">Giving your cluster a name</h3>
<p>If you've got many Concourse clusters that you switch between, you can make it slightly easier to notice which one
you're on by giving each cluster a name:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nv">CONCOURSE_CLUSTER_NAME</span><span class="o">=</span>production
</span></code></pre></div>
<p>When set, this name will be shown in the top bar when viewing the dashboard.</p>
<h3 id="configuring-ingress-traffic">Configuring ingress traffic</h3>
<p>If your web nodes are going to be accessed multiple network layers, you will need to set <code>CONCOURSE_EXTERNAL_URL</code> to a
URL accessible by your Concourse users. If you don't set this property, logging in will incorrectly redirect to its
default value of <code>127.0.0.1</code>.</p>
<p>If your web node(s) will be behind a load balancer or reverse proxy then you will need to ensure connections made by <a href="https://concourse-ci.org/builds.html#fly-intercept">
<code>fly intercept</code></a> are properly handled by upgrading the connection.
Here is a sample nginx configuration that upgrades connections made by
<a href="https://concourse-ci.org/builds.html#fly-intercept"><code>fly intercept</code></a>.</p>
<div class="language-nginx highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span>
<span class="normal"><a href="#__codelineno-11-22">22</a></span>
<span class="normal"><a href="#__codelineno-11-23">23</a></span>
<span class="normal"><a href="#__codelineno-11-24">24</a></span>
<span class="normal"><a href="#__codelineno-11-25">25</a></span>
<span class="normal"><a href="#__codelineno-11-26">26</a></span>
<span class="normal"><a href="#__codelineno-11-27">27</a></span>
<span class="normal"><a href="#__codelineno-11-28">28</a></span>
<span class="normal"><a href="#__codelineno-11-29">29</a></span>
<span class="normal"><a href="#__codelineno-11-30">30</a></span>
<span class="normal"><a href="#__codelineno-11-31">31</a></span>
<span class="normal"><a href="#__codelineno-11-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">  </span><span class="kn">server_name</span><span class="w"> </span><span class="s">ci.example.com</span><span class="p">;</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">  </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Strict-Transport-Security</span><span class="w"> </span><span class="s">&quot;max-age=31536000&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">  </span><span class="kn">ssl_stapling</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">  </span><span class="kn">ssl_stapling_verify</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7"></a>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">  </span><span class="c1"># Proxy main concourse traffic</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">  </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">      </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://concourse.local:8080/</span><span class="p">;</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Protocol</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Host</span><span class="w"> </span><span class="nv">$http_host</span><span class="p">;</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18"></a>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="w">  </span><span class="c1"># Proxy fly intercept traffic</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20"></a><span class="w">  </span><span class="kn">location</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="sr">/hijack$</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21"></a><span class="w">      </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://concourse.local:8080</span><span class="p">;</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Protocol</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Host</span><span class="w"> </span><span class="nv">$http_host</span><span class="p">;</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28"></a><span class="w">      </span><span class="c1"># Upgrade connection</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30"></a><span class="w">      </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">&quot;upgrade&quot;</span><span class="p">;</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="tls-via-lets-encrypt">TLS via Let's Encrypt</h3>
<p>Concourse can be configured to automatically acquire a TLS certificate via <a href="https://letsencrypt.org/">Let's Encrypt</a>:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Enable TLS</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nv">CONCOURSE_TLS_BIND_PORT</span><span class="o">=</span><span class="m">443</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Enable Let&#39;s Encrypt</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="nv">CONCOURSE_ENABLE_LETS_ENCRYPT</span><span class="o">=</span><span class="nb">true</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Concourse's Let's Encrypt integration works by storing the TLS certificate and key in the database, so it is 
imperative that you enable <a href="https://concourse-ci.org/encryption.html">database encryption</a> as well.</p>
</div>
<p>By default, Concourse will reach out
to <a href="https://acme-v02.api.letsencrypt.org/directory">Let's Encrypt's ACME CA directory</a>. An alternative URL can be
configured like so:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nv">CONCOURSE_LETS_ENCRYPT_ACME_URL</span><span class="o">=</span>https://acme.example.com/directory
</span></code></pre></div>
<p>In order to negotiate the certificate, your <code>web</code> node must be reachable by the ACME server. There are
intentionally <a href="https://letsencrypt.org/docs/faq/">no publicly listed IP addresses to whitelist</a>, so this typically means
just making your <code>web</code> node publicly reachable.</p>
<h3 id="build-log-retention">Build log retention</h3>
<p>Build logs are stored in the DB - if they are not cleanup up every once in a while, the storage usage for build logs
will continue to grow as more builds run. While this is usually fine for small Concourse instances, as you scale up, you
may run into storage concerns.</p>
<p>To clean up old build logs, you can configure Concourse to periodically scan for builds whose logs should be reaped
based on a log retention policy, skipping over any paused pipelines and jobs. When a build's logs are reaped, they are
no longer visible in the UI.</p>
<p>Concourse can be configured with a default build log retention policy for all jobs:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nv">CONCOURSE_DEFAULT_BUILD_LOGS_TO_RETAIN</span><span class="o">=</span><span class="m">50</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nv">CONCOURSE_DEFAULT_DAYS_TO_RETAIN_BUILD_LOGS</span><span class="o">=</span><span class="m">14</span>
</span></code></pre></div>
<p>With these settings, Concourse will keep the latest 50 builds for each job. If a job runs more than 50 builds in 14
days, all of those builds will be retained until 14 days after they ran.</p>
<p>Some jobs have differing retention requirements - you can configure <a href="https://concourse-ci.org/jobs.html#schema.build_log_retention_policy">
<code>build_log_retention_policy</code> schema</a> on a
job-by-job basis.</p>
<p>You can also configure Concourse with maximum values for build log retention policies to prevent jobs from retaining
their build logs for too long:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nv">CONCOURSE_MAX_BUILD_LOGS_TO_RETAIN</span><span class="o">=</span><span class="m">100</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nv">CONCOURSE_MAX_DAYS_TO_RETAIN_BUILD_LOGS</span><span class="o">=</span><span class="m">30</span>
</span></code></pre></div>
<p>With these settings, <a href="https://concourse-ci.org/jobs.html#schema.build_log_retention_policy.builds">
<code>build_log_retention_policy.builds</code></a> is
capped at 100, and <a href="https://concourse-ci.org/jobs.html#schema.build_log_retention_policy.days">
<code>build_log_retention_policy.days</code></a> is capped
at 30.</p>
<h3 id="enabling-audit-logs">Enabling audit logs</h3>
<p>A very simplistic form of audit logging can be enabled with the following vars:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Enable auditing for all api requests connected to builds.</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nv">CONCOURSE_ENABLE_BUILD_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># Enable auditing for all api requests connected to containers.</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="nv">CONCOURSE_ENABLE_CONTAINER_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c1"># Enable auditing for all api requests connected to jobs.</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="nv">CONCOURSE_ENABLE_JOB_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="c1"># Enable auditing for all api requests connected to pipelines.</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="nv">CONCOURSE_ENABLE_PIPELINE_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c1"># Enable auditing for all api requests connected to resources.</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="nv">CONCOURSE_ENABLE_RESOURCE_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="c1"># Enable auditing for all api requests connected to system transactions.</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="nv">CONCOURSE_ENABLE_SYSTEM_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="c1"># Enable auditing for all api requests connected to teams.</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="nv">CONCOURSE_ENABLE_TEAM_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="c1"># Enable auditing for all api requests connected to workers.</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="nv">CONCOURSE_ENABLE_WORKER_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="c1"># Enable auditing for all api requests connected to volumes.</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="nv">CONCOURSE_ENABLE_VOLUME_AUDITING</span><span class="o">=</span><span class="nb">true</span>
</span></code></pre></div>
<p>When enabled, API requests will result in an info-level log line like so:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">{</span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="s2">&quot;2019-05-09T14:41:54.880381537Z&quot;</span><span class="p">,</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;info&quot;</span><span class="p">,</span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="s2">&quot;atc&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;atc.audit&quot;</span><span class="p">,</span><span class="nt">&quot;data&quot;</span><span class="p">:{</span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="s2">&quot;Info&quot;</span><span class="p">,</span><span class="nt">&quot;parameters&quot;</span><span class="p">:{},</span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;test&quot;</span><span class="p">}}</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="p">{</span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="s2">&quot;2019-05-09T14:42:36.704864093Z&quot;</span><span class="p">,</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;info&quot;</span><span class="p">,</span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="s2">&quot;atc&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;atc.audit&quot;</span><span class="p">,</span><span class="nt">&quot;data&quot;</span><span class="p">:{</span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="s2">&quot;GetPipeline&quot;</span><span class="p">,</span><span class="nt">&quot;parameters&quot;</span><span class="p">:{</span><span class="nt">&quot;:pipeline_name&quot;</span><span class="p">:[</span><span class="s2">&quot;booklit&quot;</span><span class="p">],</span><span class="nt">&quot;:team_name&quot;</span><span class="p">:[</span><span class="s2">&quot;main&quot;</span><span class="p">]},</span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;test&quot;</span><span class="p">}}</span>
</span></code></pre></div>
<h3 id="configuring-defaults-for-resource-types">Configuring defaults for resource types</h3>
<p>Defaults for the "core" resource
types (<a href="https://github.com/concourse?q=-resource">those that show up under the Concourse org</a>) that comes with Concourse
can be set cluster-wide by passing in a configuration file. The format of the file is the name of the resource type
followed by an arbitrary configuration.</p>
<p>Documentation for each resource type's configuration is in each implementation's <code>README</code>.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nv">CONCOURSE_BASE_RESOURCE_TYPE_DEFAULTS</span><span class="o">=</span>./defaults.yml
</span></code></pre></div>
<p>For example, a <code>defaults.yml</code> that configures the entire cluster to use a registry mirror would have:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nt">registry-image</span><span class="p">:</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">  </span><span class="nt">registry_mirror</span><span class="p">:</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://registry.mirror.example.com</span>
</span></code></pre></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../generating-keys/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Generating Keys">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Generating Keys
              </div>
            </div>
          </a>
        
        
          
          <a href="../running-worker/" class="md-footer__link md-footer__link--next" aria-label="Next: Running a worker node">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Running a worker node
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.top", "content.code.copy", "attr_list", "md_in_html", "pymdownx.blocks.caption", "navigation.footer"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>